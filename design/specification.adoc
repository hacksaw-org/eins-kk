//==========
// 属性(Attribute)
//==========
:author: fukaor 
:revnumber:  0.1
:email: rey19951005@gmail.com
:last-update-label: 最終更新
:lang:      ja
:doctype:   book
:chapter-signifier: 
:toc: left
:toc-title: 目次
:scripts: cjk
:sectnumlevels: 4
:sectnums:
:figure-caption: 図
:table-caption: 表
:version-label: Ver.
:title-page-background-image: image:./img/title-page-back.png[]

= システム原案

== プロジェクト概要

=== 目的

システムによるWeb画面で表示される株式の分析結果及びメール通知の内容から、ユーザが調査の必要なく簡易に投資判断ができるようにすることを目的とする。

=== 概要

 * システムはRSI投資法によって投資対象として有望と判断できる株式を調査、分析する。
 * システムは分析した結果をメール及びWeb画面描画によってユーザに提供する。
 * システムはユーザのメールアドレスといった個人情報を保管していることから、提供するWeb画面にアクセスする際には認証を行う。
 * システム全体の概要図を下記に示す。

image::./img/PJ概要図.png[align="center"]

== 仕様

=== 分析処理仕様

==== 対象銘柄

調査及び分析の対象はJPX日経インデックス400の構成銘柄とする。JPX日経インデックス400の構成銘柄が更新された場合は、調査及び分析対象も更新する。

==== 通知先ユーザ

ユーザデータは暗号化した上で管理を行う。通知先ユーザデータとして下記を管理し、各ユーザデータは必要に応じて追加/変更/削除を可能とする。

.ユーザデータ一覧
[cols="1a*3", options="header, autowidth"]
|===
2+| データ名 | 説明

2+| メールアドレス
| ユーザを一意にとするためのIDとしても利用

2+| アカウント名
| Web画面上で表示する名称

2+| パスワード
| 8桁以上20桁以下の英数字

|===

==== 投資判断種別

投資判断の種別は下記とする。

 * 買い準備
 * 買い
 * 売り準備
 * 売り

==== 分析方法

投資判断は主にRSI、25日移動平均線乖離率、75日移動平均線といったテクニカル指標を利用して行う。投資判断種別の設定値をしきい値として、テクニカル指標をもとに買いエントリーすべきか、売りエントリーすべきかの判断を行う。投資判断にあたっての優先度は下記の通りとなる。

投資判断にあたっての優先度::   
全体相場（日経平均のRSI） > 対象銘柄のRSI > 対象銘柄の25日移動平均線乖離率 > 対象銘柄の75日移動平均線

===== テクニカル指標の計算方法

投資判断にあたり必要になるテクニカル指標の計算方法を下記に示す。

.RSI, 移動平均線等の計算方法
[cols="1a*2", options="header, autowidth"]
|===
| テクニカル指標名 | 計算式

| RSI(相対力指数)
| 14日間の値上がり幅の平均 / (14日間の値上がり幅の平均 + 14日間の値下がり幅の平均) * 100 + 
  値上がり幅の算出：前日終値 − 当日終値

| 25日移動平均線乖離率
| 25日移動平均線 = （本日の終値 + 昨日の終値 + 2日前の終値 + … + 25日前の終値） / 25 +
  25日移動平均線乖離率 = （株価 - 25日移動平均線） / 25日移動平均線

| 75日移動平均線
| 75日移動平均線 = （本日の終値 + 昨日の終値 + 2日前の終値 + … + 75日前の終値） / 75

|===

// MACDも追加したい

===== 投資判断種別の設定

投資判断におけるしきい値は運用中の任意のタイミングで変更できるものとする。しきい値の初期設定を下記に示す。

TIP:  RSIが25を下回った場合、買い準備の判定 + 
      RSIが20を下回った場合、買いの判定 + 
      RSIが75を上回った場合、売り準備の判定 + 
      RSIが80を上回った場合、売りの判定 + 
      25日移動平均線乖離率が-10%を下回った場合、買いの判定 + 
      25日移動平均線乖離率が+10%を上回った場合、売りの判定 + 
      75日移動平均線が+の場合、買いの判定 + 
      75日移動平均線が-の場合、売りの判定

===== 通知対象の判断

全体相場及び対象銘柄のRSIの両方に投資判断種別の設定がされた場合、ユーザへの通知対象とする。

==== 分析の実施時刻

東京証券取引所の休業日を除き、毎日2回実施する。実施時刻は売買立会の午後立会終了1時間前（14:00）及び午後立会終了時点（15:00）とし、実施時刻時点での市場情報をもとに分析を実施する。このとき、午後立会終了1時間前の分析結果は後立会終了30分前までに完了させる。

==== 要注意銘柄の判断

分析の結果投資対象と判断されており、かつ下記に該当する銘柄については要注意銘柄とする。

 * 事件、事故銘柄
 * ストップ銘柄
 * 出来高50万未満の銘柄

===== 事件、事故銘柄の判定について

特定の銘柄に対する直近1日でのニュース数を算出し、しきい値を超えた場合に事件、事故銘柄として判定する。ニュース数の取得期間及びニュース数のしきい値については必要に応じて変更可能であるものとする。しきい値の初期設定を下記に示す。

TIP:  直近1日で3件以上のニュースが存在する場合、事件、事故銘柄の判定

===== ストップ安、ストップ高の判定について

「ストップ安」や「ストップ高」は、1日の株価の上昇や下落の変動幅を一定範囲内に制限するための仕組みで、その制限を超えた株価になった場合、その日は取引ができなくなる。
判定方法を下記に示す。

.ストップ高、ストップ安の判定
[cols="1a*2", options="header, autowidth"]

|===
| 前日終値 | 制限値幅（この値以上に上下）
| 100円未満	    | 30円
| 200円未満	    | 50円
| 500円未満	    | 80円
| 700 円未満	  | 100円
| 1,000円未満	  | 150円
| 1,500円未満	  | 300円
| 2,000円未満	  | 400円
| 3,000円未満	  | 500円
| 5,000円未満	  | 700円
| 7,000 円未満	| 1,000円
| 10,000円未満	| 1,500円
| 15,000円未満	| 3,000円
| 20,000円未満	| 4,000円
|===

==== 分析結果

===== 画面表示

分析完了後、分析結果をWeb画面上で確認可能とする。Web画面仕様は後述。

===== メール通知

分析完了後、下記の情報を記載しユーザのメールアドレス宛にメールを送る。

.メール内容
[cols="1a*2", options="header, autowidth"]
|===

| 項目 | 内容

| 調査実施日時
| yyyy/MM/dd hh:mm:ss表記

| URL
| 分析結果のURL

| 投資判断種別
| 分析の結果推奨される種別

| 対象銘柄名称及びコード
| 投資判断種別ごとにソートして表示

| 要注意銘柄の判断
| 該当する場合はその旨を表示

| 分析結果抜粋
| 全体相場（日経平均のRSI）、対象銘柄のRSI、対象銘柄の25日移動平均線乖離率、対象銘柄の75日移動平均線の投資判断種別をそれぞれ示す

|===

// メール文面のイメージ図を追加

===== データ保存

調査結果はCSVファイルで出力し保管する。30日以上前に出力したCSVファイルについては圧縮を行う。

=== 画面処理仕様

Figmaにて記載する。

https://www.figma.com/team_invite/redeem/0q18RH35wTqJxPIQweemCY

=== システム構成図

